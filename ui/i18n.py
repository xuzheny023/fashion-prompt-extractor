# -*- coding: utf-8 -*-
"""
UI i18n for Cloud-Only Minimal Version
æžç®€äº‘ç«¯ç‰ˆ UI æ–‡æ¡ˆ
"""

TRANSLATIONS = {
    "zh": {
        # App
        "app.title": "AI é¢æ–™è¯†åˆ«ä¸Žåˆ†æž",
        "app.subtitle": "åŸºäºŽäº‘ç«¯ Qwen-VL çš„æ™ºèƒ½é¢æ–™åˆ†æžå·¥å…·",
        
        # Sidebar
        "sidebar.title": "ðŸ‘” é¢æ–™åˆ†æžå™¨",
        "sidebar.subtitle": "AI-Powered Fabric Recognition",
        "sidebar.upload": "ðŸ“¤ ä¸Šä¼ å›¾ç‰‡",
        "sidebar.upload_help": "æ”¯æŒ JPGã€PNG æ ¼å¼",
        "sidebar.settings": "âš™ï¸ å‚æ•°è®¾ç½®",
        "sidebar.language": "ðŸŒ è¯­è¨€ / Language",
        "sidebar.crop_size": "ðŸ“ é€‰æ¡†å¤§å° (px)",
        "sidebar.zoom": "ðŸ” é¢„è§ˆæ”¾å¤§å€æ•°",
        "sidebar.top_k": "ðŸ“Š è¿”å›žç»“æžœæ•°",
        "sidebar.about": "ðŸ“– å…³äºŽ",
        
        # Main Panel
        "main.upload_prompt": "ðŸ‘ˆ è¯·ä¸Šä¼ å›¾ç‰‡å¼€å§‹åˆ†æž",
        "main.adjust_crop": "ðŸ‘ˆ æ‹–åŠ¨è°ƒæ•´è£å‰ªæ¡†",
        "main.preview_title": "é¢„è§ˆåŒºåŸŸ",
        "main.crop_info": "è£å‰ª: {w}Ã—{h} px",
        "main.preview_info": "é¢„è§ˆ: {size}Ã—{size} px (Ã—{zoom})",
        "main.recognize_button": "ðŸš€ è¯†åˆ«è¯¥åŒºåŸŸ",
        "main.recognizing": "â˜ï¸ è°ƒç”¨äº‘ç«¯è¯†åˆ«ä¸­...",
        "main.success": "âœ… è¯†åˆ«å®Œæˆï¼",
        
        # Results
        "result.engine": "Engine: {engine}",
        "result.no_materials": "æœªè¯†åˆ«åˆ°ææ–™",
        "result.reasoning_title": "ðŸ’¡ è§£é‡Š / Reasoning",
        "result.reasoning_subtitle": "ç”±äº‘ç«¯å¤§æ¨¡åž‹ç”Ÿæˆ",
        
        # Errors
        "error.no_api_key": "æœªé…ç½® DASHSCOPE_API_KEYï¼Œè¯·åœ¨ Secrets ä¸­æ·»åŠ åŽé‡è¯•ã€‚",
        "error.config_steps": """
**é…ç½®æ­¥éª¤ï¼š**
1. åˆ›å»º `.streamlit/secrets.toml`
2. æ·»åŠ ï¼š`DASHSCOPE_API_KEY = "sk-your-key-here"`
3. é‡å¯åº”ç”¨
""",
        "error.recognition_failed": "âŒ è¯†åˆ«å¤±è´¥: {error}",
        "error.timeout": "â±ï¸ **ç½‘ç»œè¶…æ—¶** - è¯·æ£€æŸ¥ç½‘ç»œè¿žæŽ¥æˆ–ç¨åŽé‡è¯•",
        "error.network": "ðŸŒ **ç½‘ç»œè¿žæŽ¥é—®é¢˜** - è¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®",
        "error.quota": "ðŸ“Š **API é…é¢ä¸è¶³** - è¯·ç¨åŽå†è¯•æˆ–æ£€æŸ¥è´¦æˆ·ä½™é¢",
        "error.invalid_key": "ðŸ”‘ **API Key æ— æ•ˆ** - è¯·æ£€æŸ¥ Secrets é…ç½®",
        "error.not_found": "ðŸ” **èµ„æºæœªæ‰¾åˆ°** - è¯·è”ç³»æŠ€æœ¯æ”¯æŒ",
        "error.suggestion": "ðŸ’¡ **å»ºè®®**ï¼šæ£€æŸ¥ç½‘ç»œè¿žæŽ¥ã€API Key é…ç½®æˆ–ç¨åŽé‡è¯•",
        "error.image_load": "âŒ å›¾ç‰‡åŠ è½½å¤±è´¥: {error}",
        
        # Footer
        "footer.powered_by": "âš¡ Powered by Qwen-VL",
        "footer.interactive": "ðŸ–¼ï¸ Interactive Crop",
        "footer.cached": "ðŸš€ Cached for Speed",
    },
    
    "en": {
        # App
        "app.title": "AI Fabric Recognition & Analysis",
        "app.subtitle": "Intelligent Fabric Analysis Tool Powered by Cloud Qwen-VL",
        
        # Sidebar
        "sidebar.title": "ðŸ‘” Fabric Analyst",
        "sidebar.subtitle": "AI-Powered Fabric Recognition",
        "sidebar.upload": "ðŸ“¤ Upload Image",
        "sidebar.upload_help": "Supports JPG, PNG formats",
        "sidebar.settings": "âš™ï¸ Settings",
        "sidebar.language": "ðŸŒ Language",
        "sidebar.crop_size": "ðŸ“ Crop Size (px)",
        "sidebar.zoom": "ðŸ” Preview Zoom",
        "sidebar.top_k": "ðŸ“Š Top K Results",
        "sidebar.about": "ðŸ“– About",
        
        # Main Panel
        "main.upload_prompt": "ðŸ‘ˆ Please upload an image to start analysis",
        "main.adjust_crop": "ðŸ‘ˆ Drag to adjust crop box",
        "main.preview_title": "Preview Area",
        "main.crop_info": "Crop: {w}Ã—{h} px",
        "main.preview_info": "Preview: {size}Ã—{size} px (Ã—{zoom})",
        "main.recognize_button": "ðŸš€ Recognize This Area",
        "main.recognizing": "â˜ï¸ Calling cloud recognition...",
        "main.success": "âœ… Recognition complete!",
        
        # Results
        "result.engine": "Engine: {engine}",
        "result.no_materials": "No materials identified",
        "result.reasoning_title": "ðŸ’¡ Reasoning",
        "result.reasoning_subtitle": "Generated by cloud LLM",
        
        # Errors
        "error.no_api_key": "DASHSCOPE_API_KEY not configured. Please add it in Secrets and retry.",
        "error.config_steps": """
**Configuration Steps:**
1. Create `.streamlit/secrets.toml`
2. Add: `DASHSCOPE_API_KEY = "sk-your-key-here"`
3. Restart the app
""",
        "error.recognition_failed": "âŒ Recognition failed: {error}",
        "error.timeout": "â±ï¸ **Network Timeout** - Please check your connection or retry later",
        "error.network": "ðŸŒ **Network Connection Issue** - Please check network settings",
        "error.quota": "ðŸ“Š **API Quota Exceeded** - Please retry later or check account balance",
        "error.invalid_key": "ðŸ”‘ **Invalid API Key** - Please check Secrets configuration",
        "error.not_found": "ðŸ” **Resource Not Found** - Please contact support",
        "error.suggestion": "ðŸ’¡ **Suggestion**: Check network connection, API Key configuration, or retry later",
        "error.image_load": "âŒ Image load failed: {error}",
        
        # Footer
        "footer.powered_by": "âš¡ Powered by Qwen-VL",
        "footer.interactive": "ðŸ–¼ï¸ Interactive Crop",
        "footer.cached": "ðŸš€ Cached for Speed",
    }
}


def t(key: str, lang: str = "zh", **kwargs) -> str:
    """
    Get translated text
    
    Args:
        key: Translation key (e.g., "app.title")
        lang: Language code ("zh" or "en")
        **kwargs: Format parameters
    
    Returns:
        Translated and formatted text
    """
    lang = lang.lower()
    if lang not in TRANSLATIONS:
        lang = "zh"
    
    text = TRANSLATIONS[lang].get(key, key)
    
    if kwargs:
        try:
            return text.format(**kwargs)
        except (KeyError, ValueError):
            return text
    
    return text


__all__ = ["TRANSLATIONS", "t"]
