:root {
  --radius-sm: 6px;
  --radius-md: 10px;
  --radius-lg: 14px;
  /* Light theme colors */
  --card-bg: #ffffff;
  --card-border-color: rgba(0, 0, 0, 0.08);
  --text-muted: rgba(0, 0, 0, 0.55);
  --text-primary: #1f2937;
  --hover-bg: rgba(0, 0, 0, 0.04);
  --focus-ring: rgba(59, 130, 246, 0.5);
  /* Dark theme colors */
  --card-bg-dark: #1e293b;
  --card-border-color-dark: rgba(255, 255, 255, 0.1);
  --text-muted-dark: rgba(255, 255, 255, 0.65);
  --text-primary-dark: #f1f5f9;
  --hover-bg-dark: rgba(255, 255, 255, 0.05);
  --focus-ring-dark: rgba(96, 165, 250, 0.6);
  /* Layout */
  --container-max-width: 1400px;
  --container-gutter: 12px;
  /* Typography scale */
  --font-size-caption: 0.875rem;
  --font-size-body: 1rem;
  --font-size-subhead: 1.125rem;
  --font-size-heading: 1.25rem;
  --line-height-tight: 1.25;
  --line-height-normal: 1.5;
  --line-height-relaxed: 1.625;
  /* Spacing scale */
  --space-xs: 4px;
  --space-sm: 8px;
  --space-md: 12px;
  --space-lg: 16px;
  --space-xl: 24px;
}

/* Global box-sizing to prevent width overflow accumulation */
html { box-sizing: border-box; }
*, *::before, *::after { box-sizing: inherit; }

/* Dark theme support */
@media (prefers-color-scheme: dark) {
  :root {
    --card-bg: var(--card-bg-dark);
    --card-border-color: var(--card-border-color-dark);
    --text-muted: var(--text-muted-dark);
    --text-primary: var(--text-primary-dark);
    --hover-bg: var(--hover-bg-dark);
    --focus-ring: var(--focus-ring-dark);
  }
}

/* Temporarily disable width-limiting container styles to allow full-width layout
.app-shell {
  max-width: var(--container-max-width);
  margin: 0 auto;
  padding-left: var(--container-gutter);
  padding-right: var(--container-gutter);
}
*/

.sticky {
  position: sticky;
  top: 12px; /* keep within column, no viewport offsets */
  width: 100%; /* inherit column width */
  align-self: flex-start;
  max-height: calc(100vh - 12px);
  overflow: auto; /* right column scrolls internally */
}

/* Right pane fence: keep within column and scroll internally */
.right-pane {
  position: sticky;
  top: 12px;
  max-height: calc(100vh - 24px);
  overflow: auto;
}

.card {
  background: var(--card-bg);
  border: 1px solid var(--card-border-color);
  border-radius: var(--radius-md);
  padding: var(--space-lg) var(--space-lg);
  margin-bottom: var(--space-lg); /* 16px rhythm */
  box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.03);
  transition: box-shadow 0.15s ease-in-out;
}

.card:hover {
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
}

/* Typography harmonization */
.card h3, .card .subhead {
  font-size: var(--font-size-subhead);
  line-height: var(--line-height-tight);
  margin: 0 0 var(--space-sm) 0;
  color: var(--text-primary);
  font-weight: 600;
}

.card p, .card .body {
  font-size: var(--font-size-body);
  line-height: var(--line-height-normal);
  margin: 0 0 var(--space-sm) 0;
  color: var(--text-primary);
}

.card .muted, .card .caption {
  color: var(--text-muted);
  font-size: var(--font-size-caption);
  line-height: var(--line-height-normal);
  margin: 0;
}

/* List rows: unified spacing and alignment */
.card .row {
  display: flex;
  align-items: baseline;
  justify-content: space-between;
  gap: var(--space-md);
  padding: var(--space-sm) 0; /* 8px internal row spacing */
  line-height: var(--line-height-normal);
}
.card .row .idx {
  width: 2ch;
  color: var(--text-muted);
  text-align: right;
}
.card .row .name {
  flex: 1;
  font-weight: 600;
}
.card .row .score {
  min-width: 4ch;
  text-align: right;
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
  color: var(--text-muted);
}
.card .desc {
  margin: 0 0 var(--space-sm) 2ch; /* indent under the row, ~2 chars */
  color: var(--text-muted);
  font-size: var(--font-size-caption);
}

/* Button refinements with hover feedback - version-agnostic */
.card button {
  border-radius: var(--radius-sm) !important;
  transition: all 0.15s ease-in-out !important;
  font-size: var(--font-size-body) !important;
  padding: var(--space-sm) var(--space-md) !important;
  border: 1px solid var(--card-border-color) !important;
}

.card button:hover {
  background-color: var(--hover-bg) !important;
  transform: translateY(-1px);
  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.08) !important;
}

.card button:focus {
  outline: 2px solid var(--focus-ring) !important;
  outline-offset: 2px !important;
}

/* Button row: consistent sizing */
.card .btn-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-sm);
}
.card .btn-row .stButton > button,
.card .stButton > button {
  width: 100%;
  border-radius: var(--radius-sm) !important;
}

/* Accessible focus states for interactive elements - version-agnostic */
.card input:focus,
.card select:focus,
.card textarea:focus {
  outline: 2px solid var(--focus-ring) !important;
  outline-offset: 2px !important;
}

/* Compact but readable spacing */
.card > *:last-child {
  margin-bottom: 0;
}

.card .metric-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--space-xs) 0;
  border-bottom: 1px solid var(--card-border-color);
}

.card .metric-row:last-child {
  border-bottom: none;
}

/* Recent clicks list styling */
.card .recent-click-item {
  padding: var(--space-xs) var(--space-sm);
  border-radius: var(--radius-sm);
  margin-bottom: var(--space-xs);
  background: rgba(0, 0, 0, 0.02);
  font-size: var(--font-size-caption);
  color: var(--text-muted);
}

@media (prefers-color-scheme: dark) {
  .card .recent-click-item {
    background: rgba(255, 255, 255, 0.03);
  }
}

/* High contrast warnings and tips */
.card .warning-tip {
  background: #fef3c7;
  color: #92400e;
  padding: var(--space-sm);
  border-radius: var(--radius-sm);
  margin: var(--space-sm) 0;
  border-left: 3px solid #f59e0b;
}

@media (prefers-color-scheme: dark) {
  .card .warning-tip {
    background: rgba(251, 191, 36, 0.1);
    color: #fbbf24;
    border-left-color: #f59e0b;
  }
}

/* Left panel sizing & scroll behavior */
.left-pane {
  min-width: 420px;
  max-width: 560px;
}

.left-scroll {
  max-height: 74vh; /* cap image area height */
  overflow: auto;   /* scroll only inside left column when exceeding */
}

/* Ensure the main clickable image never overflows the left column */
.left-pane img,
.left-pane canvas,
.left-scroll img,
.left-scroll canvas,
.right-pane img,
.right-pane canvas {
  max-width: 100%;
  height: auto;
  display: block;
}

/* Responsive fallback: stack columns on narrow viewports */
@media (max-width: 1279px) {
  .left-pane {
    min-width: auto;
    max-width: 100%;
  }
  .left-scroll {
    max-height: 60vh; /* slightly smaller for short screens */
  }
  .right-pane {
    position: static; /* disable sticky on small screens */
    top: auto;
    max-height: none;
    overflow: visible;
    width: 100%;
  }
}

/* Ensure any thumbnails (if present) are smaller than main image */
.card img, .card canvas {
  max-width: 360px;
}


